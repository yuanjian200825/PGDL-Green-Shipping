<!DOCTYPE html>
<html lang="zh-CN">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>èˆ¹èˆ¶èƒ½è€—é¢„æµ‹ç ”ç©¶</title>
  <style>
    :root {
      --dark-bg: #0a0e1a;
      --light-bg: #ffffff;
      --accent-blue: #3b82f6;
      --accent-cyan: #06b6d4;
      --text-dark: #0f172a;
      --text-light: #e2e8f0;
      --text-muted: #94a3b8;
      --max-width: 1200px;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    /* =========================================
       æ ¸å¿ƒä¿®æ”¹ï¼šå¢å¼ºç‰ˆ Scroll Snap é…ç½®
       ========================================= */
    html,
    body {
      margin: 0;
      padding: 0;
      /* å…³é”®ï¼šé«˜åº¦å¿…é¡»å›ºå®šï¼Œoverflow ç”± scroll-container æ¥ç®¡ */
      height: 100vh;
      overflow: hidden;
      font-family: -apple-system, BlinkMacSystemFont, "PingFang SC", "Segoe UI", Roboto, sans-serif;
      background-color: var(--dark-bg);
      color: var(--text-light);
      line-height: 1.6;
    }

    /* åˆ›å»ºä¸€ä¸ªæ»šåŠ¨å®¹å™¨æ¥æ¥ç®¡æ»šåŠ¨è¡Œä¸º */
    .scroll-container {
      height: 100vh;
      overflow-y: scroll;
      /* yè½´æ–¹å‘å¼ºåˆ¶æ•æ‰ */
      scroll-snap-type: y mandatory;
      scroll-behavior: smooth;
      position: relative;
    }

    ::-webkit-scrollbar {
      width: 8px;
    }

    ::-webkit-scrollbar-track {
      background: var(--dark-bg);
    }

    ::-webkit-scrollbar-thumb {
      background: #334155;
      border-radius: 4px;
    }

    ::-webkit-scrollbar-thumb:hover {
      background: var(--accent-blue);
    }

    /* å¯¼èˆªæ  */
    nav {
      position: fixed;
      top: 0;
      width: 100%;
      padding: 1.2rem 2rem;
      background: rgba(10, 14, 26, 0.9);
      backdrop-filter: blur(12px);
      z-index: 1000;
      border-bottom: 1px solid rgba(255, 255, 255, 0.08);
    }

    .nav-content {
      max-width: var(--max-width);
      margin: 0 auto;
      display: flex;
      justify-content: center;
      align-items: center;
    }

    .nav-links {
      display: flex;
      gap: 3rem;
    }

    .nav-links a {
      color: var(--text-light);
      text-decoration: none;
      font-size: 0.95rem;
      font-weight: 500;
      opacity: 0.7;
      transition: all 0.3s;
      position: relative;
    }

    .nav-links a:hover {
      opacity: 1;
      color: var(--accent-cyan);
    }

    .nav-links a::after {
      content: '';
      position: absolute;
      width: 0;
      height: 2px;
      bottom: -5px;
      left: 0;
      background-color: var(--accent-cyan);
      transition: width 0.3s;
    }

    .nav-links a:hover::after {
      width: 100%;
    }

    /* =========================================
       æ ¸å¿ƒä¿®æ”¹ï¼šSection å¼ºåˆ¶å¸é™„
       ========================================= */
    section {
      /* æ•æ‰ç‚¹ï¼šå¯¹é½è§†å£é¡¶éƒ¨ */
      scroll-snap-align: start;
      /* é˜²æ­¢ä¸€æ¬¡æ»šè¿‡å¤šä¸ª sectionï¼Œä¿è¯ä¸€é¡µä¸€é¡µç¿» */
      scroll-snap-stop: always;

      /* å¿…é¡»å æ»¡å…¨å±ï¼Œå¦åˆ™å¸é™„æ•ˆæœä¸æ˜æ˜¾ */
      min-height: 100vh;
      width: 100%;

      /* å†…å®¹å‚ç›´å±…ä¸­ */
      display: flex;
      flex-direction: column;
      justify-content: center;

      padding: 6rem 2rem;
      max-width: var(--max-width);
      margin: 0 auto;
      position: relative;
      /* é…åˆ snap */
    }

    .section-title {
      font-size: 2.8rem;
      margin-bottom: 1rem;
      text-align: center;
      background: linear-gradient(to right, #fff, #cbd5e1);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      font-weight: 800;
    }

    .section-subtitle {
      text-align: center;
      color: var(--text-muted);
      margin-bottom: 4rem;
      font-size: 1.1rem;
      max-width: 700px;
      margin-left: auto;
      margin-right: auto;
    }

    .content-wrapper {
      background: rgba(30, 41, 59, 0.4);
      border-radius: 24px;
      padding: 3rem;
      border: 1px solid rgba(255, 255, 255, 0.05);
      box-shadow: 0 20px 40px rgba(0, 0, 0, 0.2);
      width: 100%;
    }

    /* Hero */
    .hero {
      height: 100vh;
      padding-top: 0;
      /* Hero ä¹Ÿéœ€è¦å¸é™„ */
      scroll-snap-align: start;
      display: flex;
      align-items: center;
      justify-content: center;
      text-align: center;
      position: relative;
      overflow: hidden;
    }

    .hero-bg {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 120%;
      height: 120%;
      background: radial-gradient(circle at center, rgba(59, 130, 246, 0.15) 0%, rgba(10, 14, 26, 0) 60%);
      z-index: -1;
      pointer-events: none;
    }

    .hero h1 {
      font-size: 3.8rem;
      margin-bottom: 2rem;
      line-height: 1.3;
      font-weight: 800;
      letter-spacing: -0.5px;
    }

    .hero p {
      font-size: 1.4rem;
      color: var(--text-muted);
      margin-bottom: 2.5rem;
      font-weight: 300;
      max-width: 800px;
      margin-left: auto;
      margin-right: auto;
    }

    /* Feature Cards */
    .grid-layout {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
      gap: 2rem;
    }

    .feature-card {
      background: rgba(255, 255, 255, 0.02);
      padding: 2.5rem;
      border-radius: 16px;
      border: 1px solid rgba(255, 255, 255, 0.05);
      transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
      position: relative;
      overflow: hidden;
    }

    .feature-card:hover {
      transform: translateY(-8px);
      background: rgba(255, 255, 255, 0.04);
      border-color: rgba(255, 255, 255, 0.1);
      box-shadow: 0 15px 30px rgba(0, 0, 0, 0.3);
    }

    .feature-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 4px;
      background: linear-gradient(90deg, var(--accent-blue), var(--accent-cyan));
      opacity: 0;
      transition: opacity 0.3s;
    }

    .feature-card:hover::before {
      opacity: 1;
    }

    .card-icon {
      font-size: 2.5rem;
      margin-bottom: 1.5rem;
      display: block;
    }

    .card-title {
      font-size: 1.3rem;
      margin-bottom: 1rem;
      color: var(--text-light);
      font-weight: 700;
    }

    .card-desc {
      color: var(--text-muted);
      font-size: 0.95rem;
      line-height: 1.7;
    }

    /* Code Tabs */
    .code-tabs {
      display: flex;
      gap: 1rem;
      margin-bottom: 0;
      padding: 0 1rem;
      /* è®©tabåˆ—è¡¨å¯ä»¥æ¨ªå‘æ»šåŠ¨å¦‚æœå¤ªçª„ */
      overflow-x: auto;
      scrollbar-width: none;
    }

    .code-tab {
      padding: 0.8rem 1.5rem;
      background: #1e1e1e;
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-bottom: none;
      border-radius: 8px 8px 0 0;
      color: var(--text-muted);
      cursor: pointer;
      transition: all 0.3s;
      font-size: 0.9rem;
      font-family: monospace;
      white-space: nowrap;
    }

    .code-tab:hover {
      color: var(--text-light);
      background: #252525;
    }

    .code-tab.active {
      background: #2d2d2d;
      color: var(--accent-cyan);
      border-top: 2px solid var(--accent-cyan);
      font-weight: bold;
    }

    .code-window {
      background: #1e1e1e;
      border-radius: 0 12px 12px 12px;
      overflow: hidden;
      box-shadow: 0 20px 50px rgba(0, 0, 0, 0.5);
      border: 1px solid rgba(255, 255, 255, 0.1);
    }

    .code-content-container {
      display: none;
    }

    .code-content-container.active {
      display: block;
      animation: fadeIn 0.5s;
    }

    .code-content {
      padding: 2rem;
      font-family: 'Fira Code', 'Consolas', monospace;
      font-size: 0.85rem;
      line-height: 1.6;
      color: #d4d4d4;
      overflow-x: auto;
      white-space: pre;
    }

    /* Syntax Highlighting */
    .kw {
      color: #569cd6;
      font-weight: bold;
    }

    .fn {
      color: #dcdcaa;
    }

    .str {
      color: #ce9178;
    }

    .cm {
      color: #6a9955;
      font-style: italic;
    }

    .num {
      color: #b5cea8;
    }

    .cls {
      color: #4ec9b0;
    }

    /* =========================================
       æ ¸å¿ƒä¿®æ”¹ï¼šPlaceholder Box (å›¾è¡¨å®¹å™¨)
       é‡æ–°è®¾è®¡ä¸ºâ€œä¸Šæ ‡é¢˜ + ä¸‹å›¾ç‰‡â€çš„ç»“æ„
       ========================================= */
    .placeholder-box {
      border: 2px dashed rgba(255, 255, 255, 0.1);
      background: rgba(255, 255, 255, 0.01);
      border-radius: 12px;
      /* æ”¹ä¸º flex-columnï¼Œå†…å®¹ä»ä¸Šåˆ°ä¸‹æ’åˆ— */
      display: flex;
      flex-direction: column;
      align-items: center;
      /* ç§»é™¤ justify-content: centerï¼Œè®©æ ‡é¢˜é¡¶ä¸Šå» */
      justify-content: flex-start;
      padding: 1rem;
      /* ç»™å®¹å™¨åŠ å†…è¾¹è· */
      color: var(--text-muted);
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
      height: 100%;
      /* å®¹å™¨é«˜åº¦è‡ªé€‚åº”æˆ–ç»§æ‰¿ */
      min-height: 350px;
      /* æœ€å°é«˜åº¦ */
    }

    .placeholder-box:hover {
      border-color: var(--accent-blue);
      background: rgba(59, 130, 246, 0.05);
    }

    /* å›¾è¡¨æ ‡é¢˜åŒºåŸŸ */
    .chart-header {
      width: 100%;
      text-align: center;
      margin-bottom: 1rem;
      z-index: 2;
      /* ä¿è¯æ–‡å­—åœ¨ä¸Šå±‚ */
    }

    .chart-title {
      font-weight: bold;
      color: var(--text-light);
      font-size: 1rem;
    }

    .chart-desc {
      font-size: 0.8rem;
      color: var(--text-muted);
      margin-top: 0.2rem;
    }

    /* å›¾ç‰‡å®¹å™¨åŒºåŸŸï¼šå æ®å‰©ä½™ç©ºé—´ */
    .chart-content {
      flex-grow: 1;
      width: 100%;
      display: flex;
      align-items: center;
      justify-content: center;
      position: relative;
      overflow: hidden;
      border-radius: 8px;
      background: rgba(0, 0, 0, 0.2);
      /* ç»™å›¾ç‰‡åŠ ä¸ªæ·±è‰²åº•ï¼Œé˜²æ­¢é€æ˜å›¾çœ‹ä¸æ¸… */
    }

    /* Image Styling */
    .chart-img {
      max-width: 100%;
      max-height: 100%;
      object-fit: contain;
      /* ä¿æŒæ¯”ä¾‹ï¼Œå®Œæ•´æ˜¾ç¤º */
      display: block;
    }

    /* Fallback Styling (æ— å›¾ç‰‡æ—¶æ˜¾ç¤ºçš„å›¾æ ‡) */
    .placeholder-text {
      text-align: center;
      opacity: 0.5;
    }

    /* Animations (Bouncy Effect) */
    .fade-in {
      opacity: 0;
      transform: translateY(60px) scale(0.95);
      transition: opacity 0.8s ease-out, transform 1s cubic-bezier(0.34, 1.56, 0.64, 1);
    }

    .fade-in.visible {
      opacity: 1;
      transform: translateY(0) scale(1);
    }

    .delay-1 {
      transition-delay: 0.1s;
    }

    .delay-2 {
      transition-delay: 0.2s;
    }

    .delay-3 {
      transition-delay: 0.3s;
    }

    .delay-4 {
      transition-delay: 0.4s;
    }

    /* Footer Snap */
    .footer-snap {
      /* Footer ä¹Ÿå¯ä»¥ä½œä¸ºæœ€åä¸€ç«™ */
      scroll-snap-align: end;
      padding: 2rem 0;
    }

    .loss-grid {
      display: grid;
      /* æ ¸å¿ƒä¿®æ”¹ï¼šå¼ºåˆ¶å›ºå®šä¸º 2 åˆ—ï¼Œè¿™æ ·4å¼ å›¾å°±ä¼šè‡ªç„¶å˜ä¸º 2è¡Œx2åˆ— */
      grid-template-columns: repeat(2, 1fr);
      gap: 1.5rem;
      /* å›¾ç‰‡ä¹‹é—´çš„é—´è· */
      margin-top: 2rem;
    }

    .loss-card {
      background: rgba(0, 0, 0, 0.2);
      border: 1px solid rgba(255, 255, 255, 0.05);
      border-radius: 12px;
      padding: 1rem;
      display: flex;
      flex-direction: column;
      align-items: center;
      transition: transform 0.3s ease;
    }

    .loss-card:hover {
      transform: translateY(-5px);
      border-color: var(--accent-blue);
      background: rgba(255, 255, 255, 0.03);
    }

    .loss-img-container {
      width: 100%;
      aspect-ratio: 16/10;
      display: flex;
      align-items: center;
      justify-content: center;
      overflow: hidden;
      border-radius: 8px;
      background: white;
      margin-bottom: 1rem;
    }

    .loss-img {
      width: 100%;
      height: 100%;
      object-fit: contain;
    }

    .loss-label {
      color: var(--text-light);
      font-size: 0.95rem;
      font-weight: 600;
    }
  </style>
</head>

<body>

  <!-- 
    æ ¸å¿ƒä¿®æ”¹ï¼šå¢åŠ ä¸€ä¸ª scroll-container 
    è¿™æ˜¯å®ç°å¼ºåŠ›æ»šåŠ¨å¸é™„çš„å…³é”®ï¼Œå®ƒæ¥ç®¡äº†æ•´ä¸ªé¡µé¢çš„æ»šåŠ¨
  -->
  <div class="scroll-container">

    <nav>
      <div class="nav-content">
        <div class="nav-links">
          <a href="#overview">æ¦‚è§ˆ</a>
          <a href="#methodology">æŠ€æœ¯æ–¹æ¡ˆ</a>
          <a href="#training">æ¨¡å‹è®­ç»ƒ</a>
          <a href="#ablation">æ¶ˆèå®éªŒ</a>
          <a href="#code">æ ¸å¿ƒä»£ç </a>
          <a href="#conclusion">é¡¹ç›®æ€»ç»“</a>
        </div>
      </div>
    </nav>

    <!-- Hero Section -->
    <section id="overview" class="hero">
      <div class="hero-bg"></div>
      <div class="fade-in">
        <h1>ç‰©ç†ç‰¹å¾ä¸æ·±åº¦å­¦ä¹ <br>èˆ¹èˆ¶èƒ½è€—é¢„æµ‹</h1>
        <p>åŸºäº AIS å¤§æ•°æ®ä¸æµä½“åŠ›å­¦å…ˆéªŒçš„èƒ½è€—ä¼°ç®—ç ”ç©¶</p>

        <div style="margin-top: 2.5rem;">
          <a href="#methodology"
            style="background: var(--accent-blue); color: white; padding: 0.8rem 2rem; border-radius: 50px; text-decoration: none; font-weight: 600; margin-right: 1rem;">æŸ¥çœ‹æ–¹æ¡ˆ</a>
          <a href="#code"
            style="background: rgba(255,255,255,0.1); color: white; padding: 0.8rem 2rem; border-radius: 50px; text-decoration: none; font-weight: 600;">æŸ¥çœ‹ä»£ç </a>
        </div>
      </div>
    </section>

    <!-- Methodology Section -->
    <section id="methodology">
      <h2 class="section-title fade-in">æŠ€æœ¯æ–¹æ¡ˆ</h2>
      <p class="section-subtitle fade-in delay-1">èåˆæµä½“åŠ›å­¦å…ˆéªŒçŸ¥è¯†çš„æ•°æ®å·¥ç¨‹ä¸ç‰¹å¾æ„å»º</p>

      <div class="content-wrapper fade-in delay-2">
        <div class="grid-layout">
          <div class="feature-card fade-in delay-1">
            <span class="card-icon">ğŸ“</span>
            <h3 class="card-title">ç‰©ç†å¼•å¯¼ç‰¹å¾å·¥ç¨‹</h3>
            <p class="card-desc">æ˜¾å¼å¼•å…¥ <b>$SOG^3$ (ç«‹æ–¹èˆªé€Ÿ)</b> å’Œ <b>$Wave^2$ (æ³¢æµªå¢é˜»)</b> ç­‰æµä½“åŠ›å­¦å…ˆéªŒç‰¹å¾ï¼Œæ˜¾è‘—é™ä½æ¨¡å‹å­¦ä¹ éçº¿æ€§ç‰©ç†è§„å¾‹çš„éš¾åº¦ã€‚</p>
          </div>
          <div class="feature-card fade-in delay-2">
            <span class="card-icon">ğŸ”§</span>
            <h3 class="card-title">è¿­ä»£å¼æ•°æ®æ¸…æ´—</h3>
            <p class="card-desc">
              å®æ–½åé¦ˆé©±åŠ¨çš„æ¸…æ´—ç­–ç•¥ï¼šé€šè¿‡<b>ç»´åº¦ä¿®æ­£ (Reshape)</b> è§£å†³åºåˆ—ç»“æ„é—®é¢˜ï¼Œå¹¶åº”ç”¨ <b>3Ïƒ ç»Ÿè®¡æ»¤æ³¢</b> ä¸ <b>ç‰©ç†è¾¹ç•Œçº¦æŸ</b> å‰”é™¤æç«¯ç¦»ç¾¤å€¼ï¼Œæ„å»ºé«˜è´¨é‡æ•°æ®é›†ã€‚
            </p>
          </div>
          <div class="feature-card fade-in delay-3">
            <span class="card-icon">âš¡</span>
            <h3 class="card-title">é«˜æ€§èƒ½è®­ç»ƒç­–ç•¥</h3>
            <p class="card-desc">
              é’ˆå¯¹æµ·é‡ AIS æ•°æ®ï¼Œé‡‡ç”¨ <b>ç£ç›˜å†…å­˜æ˜ å°„ (Memory Mapping)</b> æŠ€æœ¯å®ç°é›¶æ‹·è´åŠ è½½ï¼Œå¹¶é›†æˆ <b>ReduceLROnPlateau</b> è‡ªé€‚åº”è°ƒæ•´å­¦ä¹ ç‡ï¼Œæœ‰æ•ˆè§£å†³ OOM
              é—®é¢˜å¹¶åŠ é€Ÿæ”¶æ•›ã€‚
            </p>
          </div>
        </div>

        <!-- 
          ä¿®æ”¹ï¼šè°ƒæ•´ç›’å­å¸ƒå±€ä¸º [ä¸Šï¼šæ ‡é¢˜åŒº] + [ä¸‹ï¼šå›¾ç‰‡åŒº]
          height: 600px; max-width: 800px; é€‚é…æ­£æ–¹å½¢åœ°å›¾
        -->
        <div class="placeholder-box fade-in delay-4"
          style="margin-top: 3rem; height: 650px; max-width: 800px; margin-left: auto; margin-right: auto;">

          <!-- 1. é¡¶éƒ¨ï¼šå›ºå®šçš„æ ‡é¢˜åŒºåŸŸ (ä¸ä¼šè¢«å›¾ç‰‡é®æŒ¡) -->
          <div class="chart-header">
            <div class="chart-title">ç ”ç©¶åŒºåŸŸä¸ AIS è½¨è¿¹æ—¶ç©ºåˆ†å¸ƒå›¾</div>
            <div class="chart-desc">å±•ç¤ºä¼‘æ–¯é¡¿èˆªé“ (Houston Ship Channel) çš„å†…æ²³ä¸å¤–æµ·æ•°æ®è¦†ç›–èŒƒå›´</div>
          </div>

          <!-- 2. åº•éƒ¨ï¼šå›¾ç‰‡å®¹å™¨ -->
          <div class="chart-content">
            <!-- ä¿®æ”¹ï¼šä½¿ç”¨æ–°çš„æ–‡ä»¶å seasonal_map.png -->
            <img src="./seasonal_map.png" alt="ç ”ç©¶åŒºåŸŸä¸ AIS è½¨è¿¹æ—¶ç©ºåˆ†å¸ƒå›¾" class="chart-img"
              onerror="this.style.display='none'; this.parentNode.querySelector('.placeholder-text').style.display='block';">

            <!-- Fallback text (å¦‚æœå›¾ç‰‡æ²¡åŠ è½½å‡ºæ¥æ˜¾ç¤ºè¿™ä¸ª) -->
            <div class="placeholder-text" style="display: none;">
              <div style="font-size: 3rem; margin-bottom: 1rem;">ğŸ—ºï¸</div>
              <p>Map Visualization Placeholder</p>
            </div>
          </div>

        </div>
      </div>
    </section>

    <!-- Model Training Section -->
    <section id="training">
      <h2 class="section-title fade-in">æ¨¡å‹è®­ç»ƒ</h2>
      <p class="section-subtitle fade-in delay-1">å¤šå±‚æ¬¡æ¨¡å‹å¯¹æ¯”ä¸è®­ç»ƒç¨³å®šæ€§éªŒè¯</p>
      <div class="content-wrapper fade-in delay-2">

        <div class="grid-layout">
          <div class="feature-card fade-in delay-1" style="border-color: var(--accent-blue);">
            <h3 class="card-title" style="color: var(--accent-blue);">ä¼ ç»ŸåŸºçº¿æ¨¡å‹</h3>
            <ul style="list-style: none; color: var(--text-muted); line-height: 2;">
              <li>ğŸ”¹ <b>Ridge Regression</b>: çº¿æ€§åŸºå‡†ï¼Œç”¨äºéªŒè¯ç‰©ç†ç‰¹å¾çš„ç›¸å…³æ€§ã€‚</li>
              <li>ğŸ”¹ <b>XGBoost</b>: æ ‘æ¨¡å‹ï¼Œä½œä¸ºæ•æ‰éçº¿æ€§å…³ç³»çš„å¼ºåŠ›åŸºçº¿ã€‚</li>
            </ul>
          </div>
          <div class="feature-card fade-in delay-2" style="border-color: var(--accent-cyan);">
            <h3 class="card-title" style="color: var(--accent-cyan);">æ·±åº¦æ—¶åºæ¨¡å‹</h3>
            <ul style="list-style: none; color: var(--text-muted); line-height: 2;">
              <li>ğŸš€ <b>Attention-LSTM</b>: æ ¸å¿ƒæ¨¡å‹ï¼Œç»“åˆLSTMä¸æ³¨æ„åŠ›æœºåˆ¶ã€‚</li>
              <li>ğŸ”¹ <b>Transformer</b>: è‡ªæ³¨æ„åŠ›æœºåˆ¶å¯¹æ¯”åŸºå‡†ã€‚</li>
              <li>ğŸ”¹ <b>Pure LSTM / GRU</b>: åŸºç¡€RNNæ¨¡å‹ã€‚</li>
            </ul>
          </div>
        </div>

        <div class="fade-in delay-3" style="margin-top: 3rem; text-align: center;">
          <h3 style="color: var(--text-light); margin-bottom: 0.5rem;">æ·±åº¦å­¦ä¹ æ¨¡å‹æŸå¤±æ”¶æ•›æ›²çº¿ (Untuned)</h3>
          <p style="color: var(--text-muted); font-size: 0.9rem;">å¯¹æ¯”å„æ¨¡å‹åœ¨æœªè°ƒä¼˜çŠ¶æ€ä¸‹çš„æ”¶æ•›é€Ÿåº¦ä¸ç¨³å®šæ€§ (Epoch 1-50)</p>
        </div>

        <div class="loss-grid fade-in delay-4">

          <div class="loss-card">
            <div class="loss-img-container">
              <img src="./Attention_LSTM_untuned_loss.png" alt="Attention LSTM Loss" class="loss-img">
            </div>
            <div class="loss-label">Attention-LSTM Model</div>
          </div>

          <div class="loss-card">
            <div class="loss-img-container">
              <img src="./Transformer_untuned_loss.png" alt="Transformer Loss" class="loss-img">
            </div>
            <div class="loss-label">Transformer Model</div>
          </div>

          <div class="loss-card">
            <div class="loss-img-container">
              <img src="./LSTM_untuned_loss.png" alt="LSTM Loss" class="loss-img">
            </div>
            <div class="loss-label">Pure LSTM Model</div>
          </div>

          <div class="loss-card">
            <div class="loss-img-container">
              <img src="./GRU_untuned_loss.png" alt="GRU Loss" class="loss-img">
            </div>
            <div class="loss-label">GRU Model</div>
          </div>

        </div>
      </div>
    </section>

    <!-- Ablation Study Section -->
    <section id="ablation">
      <h2 class="section-title fade-in">æ¶ˆèå®éªŒ</h2>
      <p class="section-subtitle fade-in delay-1">éªŒè¯ç‰©ç†å¼•å¯¼ç‰¹å¾çš„æ ¸å¿ƒè´¡çŒ®</p>

      <div class="content-wrapper fade-in delay-2">
        <div style="margin-bottom: 3rem;">
          <div class="feature-card fade-in delay-1" style="border-left: 4px solid var(--accent-cyan); padding: 2rem;">
            <h3 class="card-title" style="margin-bottom: 0.5rem;">ğŸ”¬ å®éªŒè®¾è®¡é€»è¾‘</h3>
            <p style="color: var(--text-muted);">
              ä¸ºäº†éªŒè¯<b>â€œç‰©ç†å¼•å¯¼ç‰¹å¾å·¥ç¨‹â€</b>çš„æœ‰æ•ˆæ€§ï¼Œæˆ‘ä»¬åŸºäº Attention-LSTM æ¨¡å‹è¿›è¡Œäº†ç‰¹å¾æ¶ˆèæµ‹è¯•ã€‚å®éªŒé€šè¿‡<b>ç§»é™¤æµä½“åŠ›å­¦å…ˆéªŒç‰¹å¾</b>ï¼ˆ$SOG^3$ ä¸
              $Wave^2$ï¼‰ï¼Œä½†ä¿æŒæ¨¡å‹æ¶æ„ä¸è¶…å‚æ•°ä¸å˜ï¼Œä»è€Œé‡åŒ–ç‰©ç†è§„å¾‹å¯¹é¢„æµ‹ç²¾åº¦çš„å‡€è´¡çŒ®ã€‚
            </p>
          </div>
        </div>

        <div class="grid-layout" style="grid-template-columns: 1fr 1fr; gap: 2rem;">
          <!-- Chart 1 -->
          <div class="fade-in delay-2" style="display: flex; flex-direction: column;">
            <div class="placeholder-box" style="flex-grow: 1; min-height: 350px;">

              <!-- æ ‡é¢˜åŒº -->
              <div class="chart-header">
                <div class="chart-title">RMSE è¯¯å·®å¯¹æ¯”</div>
                <div class="chart-desc">Full Model vs. w/o Physics</div>
              </div>

              <!-- å›¾ç‰‡åŒº -->
              <div class="chart-content">
                <img src="./placeholder_rmse.png" alt="RMSE è¯¯å·®å¯¹æ¯”" class="chart-img"
                  onerror="this.style.display='none'; this.parentNode.querySelector('.placeholder-text').style.display='block';">
                <div class="placeholder-text" style="display: none;">
                  <div style="font-size: 3rem; margin-bottom: 1rem; color: var(--accent-blue);">ğŸ“Š</div>
                  <p>RMSE Bar Chart</p>
                </div>
              </div>

            </div>
            <p style="text-align: center; margin-top: 1rem; font-size: 0.9rem; color: var(--text-muted);">ç‰©ç†ç‰¹å¾ç§»é™¤åçš„æ€§èƒ½æ˜¾è‘—è¡°å‡
            </p>
          </div>

          <!-- Chart 2 -->
          <div class="fade-in delay-3" style="display: flex; flex-direction: column;">
            <div class="placeholder-box" style="flex-grow: 1; min-height: 350px;">

              <!-- æ ‡é¢˜åŒº -->
              <div class="chart-header">
                <div class="chart-title">é¢„æµ‹åå·®æ—¶åºå›¾</div>
                <div class="chart-desc">Physics Deviation Plot</div>
              </div>

              <!-- å›¾ç‰‡åŒº -->
              <div class="chart-content">
                <img src="./placeholder_time_series.png" alt="é¢„æµ‹åå·®æ—¶åºå›¾" class="chart-img"
                  onerror="this.style.display='none'; this.parentNode.querySelector('.placeholder-text').style.display='block';">
                <div class="placeholder-text" style="display: none;">
                  <div style="font-size: 3rem; margin-bottom: 1rem; color: var(--accent-cyan);">ğŸ“‰</div>
                  <p>Time-Series Plot</p>
                </div>
              </div>

            </div>
            <p style="text-align: center; margin-top: 1rem; font-size: 0.9rem; color: var(--text-muted);">
              ç¼ºå¤±ç‰©ç†ç‰¹å¾å¯¼è‡´é«˜é€ŸåŒºé—´çš„èƒ½è€—å‰Šå³°ç°è±¡</p>
          </div>
        </div>
      </div>
    </section>

    <!-- Code Implementation Section -->
    <section id="code">
      <h2 class="section-title fade-in">æ ¸å¿ƒä»£ç å®ç°</h2>
      <p class="section-subtitle fade-in delay-1">åŸºäº TensorFlow çš„ç‰©ç†å¼•å¯¼æ·±åº¦å­¦ä¹ æ¡†æ¶å®ç°</p>

      <div class="fade-in delay-2">

        <div class="code-tabs">
          <div class="code-tab active" onclick="switchTab(event, 'code-feature')">Feature Engineering</div>
          <div class="code-tab" onclick="switchTab(event, 'code-cleaning')">Data Cleaning</div>
          <div class="code-tab" onclick="switchTab(event, 'code-model')">Attention-LSTM</div>
          <div class="code-tab" onclick="switchTab(event, 'code-ablation')">Ablation Study</div>
          <div class="code-tab" onclick="switchTab(event, 'code-training')">Training Strategy</div>
          <div class="code-tab" onclick="switchTab(event, 'code-viz')">Visualization</div>
        </div>

        <div class="code-window">

          <!-- 1. Feature Engineering -->
          <div id="code-feature" class="code-content-container active">
            <pre class="code-content line-numbers"><code class="language-python">
<span class="cm"># File: src/preprocessor.py</span>
<span class="cm"># Context: Explicitly calculating fluid dynamics features (SOG^3, Wave^2)</span>
<span class="cm"># to linearize the learning problem.</span>

<span class="kw">def</span> <span class="fn">generate_features</span>(df):
<span class="cm"># ... (Basic feature engineering) ...</span>

<span class="cm"># 4. Physics-Guided Features</span>
<span class="cm"># Explicitly introduce cubic speed and squared wave height</span>
<span class="cm"># based on ship resistance equations (R ~ v^3)</span>
df[<span class="str">'SOG_Cubed'</span>] = df[<span class="str">'SOG'</span>] ** <span class="num">3</span>
df[<span class="str">'Wave_Squared'</span>] = df[<span class="str">'WaveHeight'</span>] ** <span class="num">2</span>

<span class="cm"># ... (Temporal features) ...</span>
<span class="kw">return</span> df
</code></pre>
          </div>

          <!-- 2. Data Cleaning -->
          <div id="code-cleaning" class="code-content-container">
            <pre class="code-content line-numbers"><code class="language-python">
<span class="cm"># File: src/preprocessor.py</span>
<span class="cm"># Context: Using statistical methods (3-sigma) and feature clipping</span>
<span class="cm"># to handle extreme outliers in AIS data.</span>

<span class="kw">def</span> <span class="fn">filter_outliers</span>(X, y, quantile_range=(<span class="num">0.005</span>, <span class="num">0.995</span>)):
<span class="cm"># 1. Filter based on y (Energy Consumption)</span>
y_lower = np.<span class="fn">quantile</span>(y, quantile_range[<span class="num">0</span>])
y_upper = np.<span class="fn">quantile</span>(y, quantile_range[<span class="num">1</span>])
y_mask = (y >= y_lower) & (y <= y_upper) <span class="cm"># 2. Filter based on X features (remove samples
  with any extreme feature)</span>
  <span class="cm"># ... (Loop through features) ...</span>

  <span class="kw">return</span> X[final_mask], y[final_mask]

  <span class="kw">def</span> <span class="fn">clip_features</span>(X, clip_range=<span class="num">5.0</span>):
  <span class="cm"># Clip features to +/- 5.0 std devs to prevent gradient explosion</span>
  <span class="kw">return</span> np.<span class="fn">clip</span>(X, -clip_range, clip_range)
</code></pre>
          </div>

          <!-- 3. Attention-LSTM Model -->
          <div id="code-model" class="code-content-container">
            <pre class="code-content line-numbers"><code class="language-python">
<span class="cm"># File: src/models/attention_lstm.py</span>
<span class="cm"># Context: The core deep learning model that uses attention</span>
<span class="cm"># to focus on critical time steps (acceleration, turning).</span>

<span class="kw">class</span> <span class="cls">TemporalAttention</span>(layers.Layer):
  <span class="kw">def</span> <span class="fn">call</span>(self, x):
  <span class="cm"># x shape: (Batch, Time, Features)</span>
  <span class="cm"># Score = tanh(Wx + b)</span>
  e = tf.keras.backend.<span class="fn">tanh</span>(tf.keras.backend.<span class="fn">dot</span>(x, self.W)
  + self.b)

  <span class="cm"># Calculate attention weights (alpha)</span>
  alpha = tf.keras.backend.<span class="fn">softmax</span>(tf.<span class="fn">squeeze</span>(e, axis=-<span class="num">1</span>))
  alpha = tf.<span class="fn">expand_dims</span>(alpha, axis=-<span class="num">1</span>)

  <span class="cm"># Weighted sum to get context vector</span>
  context = x * alpha
  context = tf.keras.backend.<span class="fn">sum</span>(context, axis=<span class="num">1</span>)
  <span class="kw">return</span> context, alpha

  <span class="kw">def</span> <span class="fn">build_attention_lstm</span>(input_shape):
  inputs = layers.<span class="fn">Input</span>(shape=input_shape)
  <span class="cm"># Stacked LSTM layers</span>
  x = layers.<span class="fn">LSTM</span>(DL_HIDDEN_UNITS, return_sequences=<span class="kw">True</span>)(inputs)
  x = layers.<span class="fn">LSTM</span>(DL_HIDDEN_UNITS, return_sequences=<span class="kw">True</span>)(x)

  <span class="cm"># Attention Mechanism</span>
  context, alpha = <span class="fn">TemporalAttention</span>()(x)

  outputs = layers.<span class="fn">Dense</span>(<span class="num">1</span>)(context)
  <span class="kw">return</span> models.<span class="fn">Model</span>(inputs=inputs, outputs=outputs)
</code></pre>
          </div>

          <!-- 4. Ablation Study -->
          <div id="code-ablation" class="code-content-container">
            <pre class="code-content line-numbers"><code class="language-python">
<span class="cm"># File: ablation_study/step2_train_model.py</span>
<span class="cm"># Context: Verifying the contribution of physics features by selectively</span>
<span class="cm"># removing them while keeping the model structure identical.</span>

<span class="cm"># Experiment Configuration: Ablation Study</span>
<span class="cm"># Compare "Full Physics" vs "No Physics"</span>
experiments = {
<span class="str">'With_Physics'</span>: {
<span class="str">'features'</span>: [<span class="str">'SOG'</span>, <span
  class="str">'SOG_Cubed'</span>, <span class="str">'WaveHeight'</span>, <span
  class="str">'Wave_Squared'</span>, ...],
<span class="str">'description'</span>: <span class="str">'Full model with physics-guided terms'</span>
},
<span class="str">'No_Physics'</span>: {
<span class="str">'features'</span>: [<span class="str">'SOG'</span>, <span
  class="str">'WaveHeight'</span>, ...], <span class="cm"># Removed SOG^3 and Wave^2</span>
<span class="str">'description'</span>: <span class="str">'Baseline model relying only on raw data'</span>
}
}

<span class="kw">for</span> exp_name, config <span class="kw">in</span> experiments.items():
<span class="fn">print</span>(f<span class="str">"Running Ablation: {exp_name}"</span>)
<span class="cm"># Train model with specific feature subset...</span>
<span class="cm"># Result: 'No_Physics' model shows higher RMSE in high-speed zones</span>
</code></pre>
          </div>

          <!-- 5. Training Strategy -->
          <div id="code-training" class="code-content-container">
            <pre class="code-content line-numbers"><code class="language-python">
<span class="cm"># File: main_step2_experiment_gpu.py</span>
<span class="cm"># Context: Handling large-scale data with memory mapping and adaptive learning
  rates.</span>

<span class="kw">class</span> <span class="cls">FastBatchGenerator</span>(tf.keras.utils.Sequence):
<span class="kw">def</span> <span class="fn">__init__</span>(self, X_path, y_path, batch_size):
<span class="cm"># Memory Mapping: Zero-copy data loading from disk</span>
self.X = np.<span class="fn">memmap</span>(X_path, dtype=<span class="str">'float32'</span>, mode=<span
  class="str">'r'</span>, shape=x_shape)
self.y = np.<span class="fn">memmap</span>(y_path, dtype=<span class="str">'float32'</span>, mode=<span
  class="str">'r'</span>, shape=y_shape)

<span class="cm"># Callbacks for stable training</span>
callbacks = [
<span class="fn">EarlyStopping</span>(monitor=<span class="str">'val_loss'</span>, patience=<span
  class="num">5</span>, restore_best_weights=<span class="kw">True</span>),
<span class="fn">ReduceLROnPlateau</span>(monitor=<span class="str">'val_loss'</span>, factor=<span
  class="num">0.2</span>, patience=<span class="num">2</span>)
]
</code></pre>
          </div>

          <!-- 6. Visualization -->
          <div id="code-viz" class="code-content-container">
            <pre class="code-content line-numbers"><code class="language-python">
<span class="cm"># File: main_step3_plot.py</span>
<span class="cm"># Context: Visualizing the learned attention weights to confirm</span>
<span class="cm"># the model learns physical logic.</span>

<span class="kw">def</span> <span class="fn">plot_attention_heatmap</span>(model, X_sample):
<span class="cm"># Extract attention weights from the trained model</span>
_, attention_weights = model.<span class="fn">predict</span>(X_sample)

<span class="cm"># Plot heatmap: Time Steps vs. Attention Intensity</span>
sns.<span class="fn">heatmap</span>(attention_weights.T, cmap=<span class="str">'viridis'</span>)
plt.<span class="fn">title</span>(<span class="str">"Temporal Attention Weights"</span>)
plt.<span class="fn">xlabel</span>(<span class="str">"Time Step (Past -> Future)"</span>)
<span class="cm"># High weights coincide with rapid acceleration events</span>
</code></pre>
          </div>

        </div>
      </div>
    </section>


    <!-- Final Conclusion Section -->
    <section id="conclusion">
      <h2 class="section-title fade-in">é¡¹ç›®æ€»ç»“</h2>
      <p class="section-subtitle fade-in delay-1">åŸºäºç‰©ç†å¼•å¯¼ä¸æ•°æ®é©±åŠ¨èåˆçš„ç ”ç©¶æˆæœ</p>

      <div class="content-wrapper fade-in delay-2">
        <div class="grid-layout" style="gap: 3rem;">
          <!-- æ ¸å¿ƒæˆæœ -->
          <div class="feature-card fade-in delay-1" style="border-color: var(--accent-blue);">
            <h3 style="color: var(--accent-blue); margin-bottom: 1.5rem; font-size: 1.4rem;">âœ… æ ¸å¿ƒæˆæœ</h3>
            <ul style="color: var(--text-muted); list-style: none; line-height: 2.2;">
              <li>ğŸ”¹ <b>Untuned RÂ² > 0.999</b>ï¼šéªŒè¯äº†ç‰©ç†å¼•å¯¼ç‰¹å¾ ($SOG^3$) å¯¹éçº¿æ€§æ˜ å°„çš„æå¼ºçº¿æ€§åŒ–èƒ½åŠ›ï¼Œæå¤§é™ä½äº†æ¨¡å‹è®­ç»ƒéš¾åº¦ã€‚</li>
              <li>ğŸ”¹ <b>å¯è§£é‡Šæ€§éªŒè¯</b>ï¼šAttention æœºåˆ¶æˆåŠŸæ•æ‰åŠ é€Ÿä¸è½¬å‘ç­‰å…³é”®èƒ½è€—äº‹ä»¶ï¼Œç‰¹å¾é‡è¦æ€§åˆ†æï¼ˆXGBoost vs Ridgeï¼‰éªŒè¯äº†ç‰©ç†ä¸€è‡´æ€§ã€‚</li>
              <li>ğŸ”¹ <b>ä½æˆæœ¬ä»£ç†æ¨¡å‹</b>ï¼šæˆåŠŸæ„å»ºäº†æ— éœ€æ˜‚è´µä¼ æ„Ÿå™¨ã€ä»…ä¾èµ–å…¬å¼€ AIS ä¸æ°”è±¡æ•°æ®çš„åŒºåŸŸçº§é«˜ç²¾åº¦èƒ½è€—ä¼°ç®—æ–¹æ¡ˆã€‚</li>
            </ul>
          </div>

          <!-- æœªæ¥å±•æœ› -->
          <div class="feature-card fade-in delay-2" style="border-color: var(--accent-cyan);">
            <h3 style="color: var(--accent-cyan); margin-bottom: 1.5rem; font-size: 1.4rem;">ğŸš€ æœªæ¥å±•æœ›</h3>
            <ul style="color: var(--text-muted); list-style: none; line-height: 2.2;">
              <li>ğŸ”¹ <b>æ³›åŒ–èƒ½åŠ›æµ‹è¯•</b>ï¼šè®¡åˆ’å°†æ¨¡å‹æ¨å¹¿è‡³å…¨çƒå…¶ä»–ç¹å¿™æ¸¯å£ï¼ˆå¦‚ä¸Šæµ·æ¸¯ã€é¹¿ç‰¹ä¸¹æ¸¯ï¼‰è¿›è¡Œè·¨åŸŸéªŒè¯ã€‚</li>
              <li>ğŸ”¹ <b>å®æ—¶ç³»ç»Ÿéƒ¨ç½²</b>ï¼šå°†è®­ç»ƒå¥½çš„è½»é‡åŒ–æ¨¡å‹å°è£…ä¸º API æœåŠ¡ï¼Œæ¥å…¥å®æ—¶ AIS æ•°æ®æµè¿›è¡Œåœ¨çº¿é¢„æµ‹ã€‚</li>
              <li>ğŸ”¹ <b>å¤šç‰©ç†åœºèåˆ</b>ï¼šå¼•å…¥æ´‹æµ (Ocean Currents) å’Œèˆ¹ä½“æ±¡åº• (Hull Fouling) å› å­ï¼Œè¿›ä¸€æ­¥æå‡åœ¨æç«¯æµ·å†µä¸‹çš„é¢„æµ‹ç²¾åº¦ã€‚</li>
            </ul>
          </div>
        </div>
      </div>
    </section>

  </div>

  <script>
    // æ»šåŠ¨æ·¡å…¥åŠ¨ç”» (Intersection Observer)
    const observer = new IntersectionObserver((entries) => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          entry.target.classList.add('visible');
        }
      });
    }, { threshold: 0.15 }); // ç¨å¾®å¢åŠ é˜ˆå€¼ï¼Œç¡®ä¿å…ƒç´ è¿›å…¥ä¸€ç‚¹åå†è§¦å‘

    document.querySelectorAll('.fade-in').forEach(el => observer.observe(el));

    // ä»£ç Tabåˆ‡æ¢é€»è¾‘
    function switchTab(event, tabId) {
      document.querySelectorAll('.code-tab').forEach(t => t.classList.remove('active'));
      document.querySelectorAll('.code-content-container').forEach(c => c.classList.remove('active'));
      event.target.classList.add('active');
      document.getElementById(tabId).classList.add('active');
    }
  </script>
</body>

</html>